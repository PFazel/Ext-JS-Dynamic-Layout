<?xml version="1.0" encoding="UTF-8"?>
<configuration debug="false">

    <property name="CONSOLE_PATTERN"
              value="%n%-7([%level]) %d{yyyy-MM-dd'T'HH:mm:ss.SSS} [%mdc{IP}] %logger{50}%n%replace(%msg){'\n','\n\t'}%n"/>
    <property name="FILE_PATTERN"
              value="%-7([%level]) %d{yyyy-MM-dd'T'HH:mm:ss.SSS} [%mdc{IP}] class: %logger{50}%n%replace(%msg){'\n','\n\t'}%n"/>

    <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>${CONSOLE_PATTERN}</pattern>
        </encoder>
    </appender>

    <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <file>../logs/internet-bank.log</file>
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <fileNamePattern>../logs/internet-bank.%d{yyyy-MM-dd}.log.zip</fileNamePattern>
        </rollingPolicy>
        <encoder>
            <pattern>${FILE_PATTERN}</pattern>
        </encoder>
    </appender>

    <appender name="SIFT" class="ch.qos.logback.classic.sift.SiftingAppender">
        <discriminator>
            <Key>IP</Key>
            <DefaultValue>channel-manager</DefaultValue>
        </discriminator>
        <sift>
            <appender name="ROLLING-${IP}" class="ch.qos.logback.core.rolling.RollingFileAppender">
                <file>../logs/${IP}/${IP}.log</file>
                <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
                    <fileNamePattern>../logs/${IP}/${IP}.%d{yyyy-MM-dd_HH}.log.zip</fileNamePattern>
                    <TimeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
                        <MaxFileSize>5MB</MaxFileSize>
                    </TimeBasedFileNamingAndTriggeringPolicy>
                </rollingPolicy>
                <encoder>
                    <pattern>${FILE_PATTERN}</pattern>
                </encoder>
            </appender>
        </sift>
    </appender>

    <logger name="com.ext_dl">
        <level value="debug"/>
    </logger>

    <logger name="com.opensymphony.xwork2.interceptor.ParametersInterceptor">
        <level value="error"/>
    </logger>

    <!--
        <logger name="org.displaytag">
            <level value="error"/>
        </logger>

        <logger name="org.apache.struts2.util.TokenHelper">
            <level value="error"/>
        </logger>
    -->

    <root>
        <level value="info"/>
        <appender-ref ref="CONSOLE"/>
        <appender-ref ref="FILE"/>
        <appender-ref ref="SIFT"/>
    </root>

</configuration>
